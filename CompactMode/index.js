(function(d,f,c,s,a,v,I,S,m){"use strict";const{ScrollView:T}=S.General,{TableRowGroup:R,TableSwitchRow:h,TableRowIcon:g}=c.findByProps("TableRowGroup");function C(){I.useProxy(a.storage);const t=s.React.createElement(g,{source:m.getAssetIDByName("ic_my_account_24px"),variant:"blurple"}),e=s.React.createElement(g,{source:m.getAssetIDByName("ic_clear_all_24px"),variant:"blurple"}),n=s.React.createElement(g,{source:m.getAssetIDByName("clock"),variant:"blurple"});return s.React.createElement(T,{style:{flex:1}},s.React.createElement(R,null,s.React.createElement(h,{label:"Show Avatars",subLabel:"Only works on iOS due to Android regrabbing emote URLs.",icon:t,disabled:s.ReactNative.Platform.OS=="android",value:a.storage.avatars??!1,onValueChange:function(r){return a.storage.avatars=r}}),s.React.createElement(h,{label:"No Inline Header",subLabel:"Puts header on a new line.",icon:e,value:a.storage.noInline??!1,onValueChange:function(r){return a.storage.noInline=r}}),s.React.createElement(h,{label:"Full Inline Timestamps",subLabel:"Shows un-truncated inline timestamps. Supports Custom Timestamps.",icon:n,value:a.storage.inlineTimestamps??!1,onValueChange:function(r){return a.storage.inlineTimestamps=r}})))}const b=c.findByName("RowManager"),u=c.findByProps("int2hex"),_=c.findByStoreName("ThemeStore"),{meta:{resolveSemanticColor:E}}=c.findByProps("colors","meta"),w=c.findByStoreName("GuildMemberStore"),B=c.findByStoreName("GuildStore"),$=c.findByProps("parseToAST");function N(t,e){const n=[],r=u.hex2int(t.tagBackgroundColor?u.int2hex(t.tagBackgroundColor):v.rawColors.BRAND_500),o=u.hex2int(E(_.theme,v.semanticColors.TEXT_MUTED)),l=w.getMember(t.guildId,e.author.id),j=B.getGuild(t.guildId);if(e.timestamp&&!a.storage.noInline&&(console.log(o),n.push({content:[{content:a.storage.inlineTimestamps?e.__customTimestamp??e.timestamp.calendar():e.timestamp.format("HH:mm:ss"),type:"text"}],type:"mention",roleColor:o,color:o,colorString:u.int2hex(o)}),n.push({content:" ",type:"text"})),(a.storage.avatars??!1)&&s.ReactNative.Platform.OS!="android"&&e.author.avatar!=null){let i=`https://cdn.discordapp.com/avatars/${e.author.id}/${e.author.avatar}.${e.author.avatar.startsWith("a_")?"gif":"png"}?size=128`;l?.avatar&&(i=`https://cdn.discordapp.com/guilds/${t.guildId}/users/${t.authorId}/avatars/${l.avatar}.${l.avatar.startsWith("a_")?"gif":"png"}?size=128`);const p={id:e.author.id,alt:"Avatar for: "+t.username,src:i,frozenSrc:i,type:"customEmoji"};n.push(p),n.push({content:" ",type:"text"})}t.tagText&&!a.storage.noInline&&(n.push({content:[{content:t.tagText,type:"text"}],type:"mention",roleColor:r,color:r,colorString:u.int2hex(r)}),n.push({content:" ",type:"text"}));const k={content:[{content:[{content:t.username,type:"text"}],type:"strong"}],type:"link",target:"usernameOnClick",context:{username:!0,usernameOnClick:{action:"bindTapUsername",userId:e.author.id,linkColor:e.colorString?s.ReactNative.processColor(e.colorString):t.usernameColor,messageChannelId:t.channelId}}};if(n.push(k),l?.iconRoleId&&a.storage.noInline){const i=j.roles[l.iconRoleId];if(i.unicodeEmoji)n.push({content:" ",type:"text"}),n.push($.parseToAST(i.unicodeEmoji)[0]);else if(i.icon&&s.ReactNative.Platform.OS!="android"){const p=`https://cdn.discordapp.com/role-icons/${t.guildId}/${i.icon}.webp?size=20`;n.push({content:" ",type:"text"}),n.push({id:i.id,alt:i.name,src:p,frozenSrc:p,type:"customEmoji"})}}return t.tagText&&a.storage.noInline&&(n.push({content:" ",type:"text"}),n.push({content:[{content:t.tagText,type:"text"}],type:"mention",roleColor:r,color:r,colorString:u.int2hex(r)})),e.timestamp&&a.storage.noInline&&(n.push({content:" ",type:"text"}),n.push({content:[{content:e.__customTimestamp??e.timestamp.calendar(),type:"text"}],type:"mention",roleColor:o,color:o,colorString:u.int2hex(o)})),n}function x(t){for(const e of t)e.type=="emoji"||e.type=="customEmoji"?e.jumboable=!1:Array.isArray(e.content)&&x(e.content)}const y=[],A=function(){y.push(f.before("generate",b.prototype,function(t){let[e]=t;e.vd_cm_realIsFirst=e.isFirst,e.isFirst=!1,e.message&&(e.message.avatarURL=void 0)})),y.push(f.after("generate",b.prototype,function(t,e){let[n]=t;if(n.rowType!==1)return;const r=n.message,{message:o}=e;if(o.type!=0&&o.type!=19||(e.renderContentOnly=!0,o.avatarURL=void 0,a.storage.noInline&&!n.vd_cm_realIsFirst))return;const l=N(o,r);o.content&&l.push({content:a.storage.noInline?`
`:" ",type:"text"}),o.content=[...l,...o.content??[]],a.storage.noInline||x(o.content)}))},P=function(){for(const t of y)t?.()};return d.onLoad=A,d.onUnload=P,d.settings=C,d})({},vendetta.patcher,vendetta.metro,vendetta.metro.common,vendetta.plugin,vendetta.ui,vendetta.storage,vendetta.ui.components,vendetta.ui.assets);

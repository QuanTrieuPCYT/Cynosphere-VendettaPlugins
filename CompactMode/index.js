(function(d,v,l,o,a,C,b,k,g){"use strict";const{ScrollView:x}=k.General,{TableRowGroup:S,TableSwitchRow:m,TableRowIcon:y}=l.findByProps("TableRowGroup");function _(){b.useProxy(a.storage);const t=o.React.createElement(y,{source:g.getAssetIDByName("ic_my_account_24px"),variant:"blurple"}),e=o.React.createElement(y,{source:g.getAssetIDByName("ic_clear_all_24px"),variant:"blurple"}),n=o.React.createElement(y,{source:g.getAssetIDByName("clock"),variant:"blurple"});return o.React.createElement(x,{style:{flex:1}},o.React.createElement(S,null,o.React.createElement(m,{label:"Show Avatars",subLabel:"Only works on iOS due to Android regrabbing emote URLs.",icon:t,disabled:o.ReactNative.Platform.OS=="android",value:a.storage.avatars??!1,onValueChange:function(i){return a.storage.avatars=i}}),o.React.createElement(m,{label:"No Inline Header",subLabel:"Puts header on a new line.",icon:e,value:a.storage.noInline??!1,onValueChange:function(i){return a.storage.noInline=i}}),o.React.createElement(m,{label:"Full Inline Timestamps",subLabel:"Shows un-truncated inline timestamps. Supports Custom Timestamps.",icon:n,value:a.storage.inlineTimestamps??!1,onValueChange:function(i){return a.storage.inlineTimestamps=i}}),o.React.createElement(m,{label:"Hide Reply Avatars",icon:t,value:a.storage.noReplyAvatars??!1,onValueChange:function(i){return a.storage.noReplyAvatars=i}})))}const I=l.findByName("RowManager");l.findByProps("int2hex");const O=l.findByStoreName("ThemeStore"),{meta:{resolveSemanticColor:E}}=l.findByProps("colors","meta"),N=l.findByStoreName("GuildMemberStore"),A=l.findByStoreName("GuildStore"),T=l.findByProps("parseToAST");function B(t,e){const n=[],i=t.tagBackgroundColor??o.ReactNative.processColor(C.rawColors.BRAND_500),s=o.ReactNative.processColor(E(O.theme,C.semanticColors.TEXT_MUTED)),u=N.getMember(t.guildId,e.author.id),r=A.getGuild(t.guildId);if(e.timestamp&&!a.storage.noInline&&(n.push({content:[{content:a.storage.inlineTimestamps?e.__customTimestamp??e.timestamp.calendar():e.timestamp.format("HH:mm:ss"),type:"inlineCode"}],type:"link",target:"usernameOnClick",context:{username:1,usernameOnClick:{action:"0",userId:"0",linkColor:s,messageChannelId:"0"},medium:!0}}),n.push({content:" ",type:"text"})),(a.storage.avatars??!1)&&o.ReactNative.Platform.OS!="android"&&e.author.avatar!=null){let c=`https://cdn.discordapp.com/avatars/${e.author.id}/${e.author.avatar}.${e.author.avatar.startsWith("a_")?"gif":"png"}?size=128`;u?.avatar&&(c=`https://cdn.discordapp.com/guilds/${t.guildId}/users/${t.authorId}/avatars/${u.avatar}.${u.avatar.startsWith("a_")?"gif":"png"}?size=128`);const p={id:e.author.id,alt:"Avatar for: "+t.username,src:c,frozenSrc:c,type:"customEmoji"};n.push(p),n.push({content:" ",type:"text"})}t.tagText&&!a.storage.noInline&&(n.push({content:[{content:t.tagText,type:"inlineCode"}],type:"link",target:"usernameOnClick",context:{username:1,usernameOnClick:{action:"0",userId:"0",linkColor:i,messageChannelId:"0"},medium:!0}}),n.push({content:" ",type:"text"}));const f={content:[{content:[{content:t.username,type:"text"}],type:"strong"}],type:"link",target:"usernameOnClick",context:{username:!0,usernameOnClick:{action:"bindTapUsername",userId:e.author.id,linkColor:e.colorString?o.ReactNative.processColor(e.colorString):t.usernameColor,messageChannelId:t.channelId}}};if(n.push(f),u?.iconRoleId&&a.storage.noInline){const c=r.roles[u.iconRoleId];if(c.unicodeEmoji)n.push({content:" ",type:"text"}),n.push(T.parseToAST(c.unicodeEmoji)[0]);else if(c.icon&&o.ReactNative.Platform.OS!="android"){const p=`https://cdn.discordapp.com/role-icons/${t.guildId}/${c.icon}.webp?size=20`;n.push({content:" ",type:"text"}),n.push({id:c.id,alt:c.name,src:p,frozenSrc:p,type:"customEmoji"})}}return t.tagText&&a.storage.noInline&&(n.push({content:" ",type:"text"}),n.push({content:[{content:t.tagText,type:"inlineCode"}],type:"link",target:"usernameOnClick",context:{username:1,usernameOnClick:{action:"0",userId:"0",linkColor:i,messageChannelId:"0"},medium:!0}})),e.timestamp&&a.storage.noInline&&(n.push({content:" ",type:"text"}),n.push({content:[{content:e.__customTimestamp??e.timestamp.calendar(),type:"inlineCode"}],type:"link",target:"usernameOnClick",context:{username:1,usernameOnClick:{action:"0",userId:"0",linkColor:s,messageChannelId:"0"},medium:!0}})),n}function R(t){for(const e of t)e.type=="emoji"||e.type=="customEmoji"?e.jumboable=!1:Array.isArray(e.content)&&R(e.content)}const h=[],w=function(){h.push(v.before("generate",I.prototype,function(t){let[e]=t;e.vd_cm_realIsFirst=e.isFirst,e.isFirst=!1,e.message&&(e.message.avatarURL=void 0)})),h.push(v.after("generate",I.prototype,function(t,e){let[n]=t;if(n.rowType!==1)return;const i=n.message,{message:s}=e;if(s.type!=0&&s.type!=19||(e.renderContentOnly=!0,s.avatarURL=void 0,a.storage.noInline&&!n.vd_cm_realIsFirst))return;const u=B(s,i);if(s.content&&u.push({content:a.storage.noInline?`
`:" ",type:"text"}),s.content=[...u,...s.content??[]],a.storage.noInline||R(s.content),s.referencedMessage?.message&&a.storage.noReplyAvatars){const r=s.referencedMessage.message;r.avatarURL=void 0;const f={content:[{content:[{content:r.username,type:"text"}],type:"strong"}],type:"link",target:"usernameOnClick",context:{username:!0,usernameOnClick:{action:"bindTapUsername",userId:r.authorId,linkColor:r.usernameColor,messageChannelId:r.channelId}}};r.attachments.length>0&&s.referencedMessage.systemContent&&(delete s.referencedMessage.systemContent,r.content||(r.content=[{content:[{content:o.i18n.Messages.REPLY_QUOTE_NO_TEXT_CONTENT_MOBILE,type:"text"}],type:"em"}]),r.content=[...r.content,{content:" ",type:"text"},T.parseToAST("\u{1F5BC}")[0]]),r.content=[f,{content:" ",type:"text"},...r.content??[]]}}))},L=function(){for(const t of h)t?.()};return d.onLoad=w,d.onUnload=L,d.settings=_,d})({},vendetta.patcher,vendetta.metro,vendetta.metro.common,vendetta.plugin,vendetta.ui,vendetta.storage,vendetta.ui.components,vendetta.ui.assets);
